// Generated by CoffeeScript 1.3.3
(function() {

  $(document).ready(function() {
    var _base;
    if (typeof (_base = $('.package')).twipsy === "function") {
      _base.twipsy();
    }
    $('.chosen-categories').chosen().change(function() {
      var form;
      form = $(this).parent();
      $.post(form.attr('action'), form.serialize(), function() {
        return true;
      });
      return false;
    });
    $('span.timeago').timeago();
    if ($("#top_dependent_packages").length !== 0) {
      $("#top_dependent_packages").ready(function() {
        return $.get('/top_dependent_packages', function(data) {
          return $("#top_dependent_packages").html(data);
        });
      });
    }
    if ($("#recently_added").length !== 0) {
      $("#recently_added").ready(function() {
        return $.get('/recently_added', function(data) {
          var recently_added_element;
          recently_added_element = $("#recently_added");
          recently_added_element.html(data);
          recently_added_element.find('.timeago').timeago();
          return recently_added_element;
        });
      });
    }
    $(".content").delegate(".close", 'click', function(event) {
      event.preventDefault();
      return $(this).parent().hide();
    });
    return $('.action a').click(function() {
      var jqXHR, self;
      self = $(this);
      jqXHR = $.ajax({
        type: 'POST',
        url: $(this).attr("href")
      });
      jqXHR.success(function(data) {
        console.log(self.find('.count'));
        return self.find('.count').text(data.count);
      });
      jqXHR.fail(function(jqxhr, message) {
        console.log(message);
        console.log(jqxhr);
        if (jqxhr.status === 403) {
          return $("#signin").dialog({
            title: jqxhr.responseText
          });
        }
      });
      return false;
    });
  });

}).call(this);
